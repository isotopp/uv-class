<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mastering `uv run` and `uvx`: how `uv` manages environments for scripts, projects, and tools on the fly.
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="/books/uv-class/06-running/"><meta property="og:site_name" content="Using uv to manage python projects"><meta property="og:title" content="Running code and tools consistently"><meta property="og:description" content="Mastering `uv run` and `uvx`: how `uv` manages environments for scripts, projects, and tools on the fly."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><meta itemprop=name content="Running code and tools consistently"><meta itemprop=description content="Mastering `uv run` and `uvx`: how `uv` manages environments for scripts, projects, and tools on the fly."><meta itemprop=datePublished content="2025-12-22T00:00:00+00:00"><meta itemprop=dateModified content="2025-12-22T00:00:00+00:00"><meta itemprop=wordCount content="1828"><title>Running code and tools consistently | Using uv to manage python projects</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=/books/uv-class/06-running/><link rel=stylesheet href=/book.min.85f17b518e8256eab1e39806e72b3659c4c4eab4911a3ac293d064c90fc68a8d.css><script defer src=/fuse.min.js></script><script defer src=/en.search.min.35e11983e71caaa90d825772c7ee2755ea00739dc9ec489556e71c7c3e85a283.js></script><link rel=alternate type=application/rss+xml href=/books/uv-class/06-running/index.xml title="Using uv to manage python projects"></head><body dir=ltr class="book-kind-section book-type-books"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Using uv to manage python projects</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/posts/>What's new?</a></li></ul><ul><li><input type=checkbox id=section-5c7e9da1f7ea456d914790ef3a5c9d96 class=toggle checked>
<label for=section-5c7e9da1f7ea456d914790ef3a5c9d96 class=flex><a href=/books/uv-class/>Using uv to manage python projects</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/books/uv-class/01-installation/>Installing and Configuring uv</a><ul></ul></li><li><a href=/books/uv-class/02-what-is-uv/>What uv is and how it works</a><ul></ul></li><li><a href=/books/uv-class/03-python-projects/>A sample project and a walkthrough</a><ul></ul></li><li><a href=/books/uv-class/04-basics/>General Options and TOML</a><ul></ul></li><li><a href=/books/uv-class/05-dependencies/>Dependencies, environments, and reproducibility</a><ul></ul></li><li><a href=/books/uv-class/06-running/ class=active>Running code and tools consistently</a><ul></ul></li><li><a href=/books/uv-class/07-collaboration/>Project hygiene and collaboration</a><ul></ul></li><li><a href=/books/uv-class/08-build-and-publish/>Building, packaging, and publishing</a><ul></ul></li><li><a href=/books/uv-class/09-uv-migration/>uv in context: migration and judgment</a><ul></ul></li><li><a href=/books/uv-class/90-python-and-c-projects/>Using uv to extend Python with C-code</a><ul></ul></li></ul></li></ul><ul><li><a href=https://github.com/isotopp/uv-class target=_blank rel=noopener>Repo for this site</a></li><li><a href=https://themes.gohugo.io/themes/hugo-book/ target=_blank rel=noopener>Made with Hugo Book</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/icons/menu.svg class=book-icon alt=Menu></label><h3>Running code and tools consistently</h3><label for=toc-control><img src=/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#running-code-with-uv-run>Running Code with <code>uv run</code></a><ul><li><a href=#ways-to-use-uv-run>Ways to use <code>uv run</code></a><ul><li><a href=#uv-run-something><code>uv run &lt;something></code></a></li><li><a href=#uv-run-scriptpy><code>uv run &lt;script>.py</code></a></li><li><a href=#uv-run--m-module><code>uv run -m &lt;module></code></a></li><li><a href=#uv-run--><code>uv run -</code></a></li></ul></li><li><a href=#where-the-environment-comes-from>Where the environment comes from</a></li><li><a href=#argument-separation>Argument Separation</a></li></ul></li><li><a href=#editable-installs>Editable Installs</a><ul><li><ul><li><a href=#what-is-editable>What is &ldquo;Editable&rdquo;?</a></li><li><a href=#uv-run---no-editable><code>uv run --no-editable</code></a></li></ul></li></ul></li><li><a href=#tool-execution-and-uvx>Tool Execution and <code>uvx</code></a><ul><li><ul><li><a href=#what-is-uvx>What is <code>uvx</code>?</a></li><li><a href=#common-tool-examples>Common Tool Examples</a></li><li><a href=#automatic-parameter-supply>Automatic Parameter Supply</a></li></ul></li></ul></li><li><a href=#multiple-environments>Multiple Environments</a><ul><li><ul><li><a href=#example-multi-version-testing>Example: Multi-version testing</a></li><li><a href=#side-by-side-environments>Side-by-side environments</a></li><li><a href=#simplifying-multi-environment-commands>Simplifying multi-environment commands</a></li></ul></li></ul></li><li><a href=#scripts>Scripts</a><ul><li><a href=#example-script>Example script</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><details open><summary><strong>Summary</strong></summary><div class=markdown-inner><p><strong>The <code>uv run</code> command</strong> is the primary way to execute code. It ensures a consistent environment is available, creating or updating it as needed.</p><p><strong>Environment Discovery:</strong> <code>uv</code> finds where it should run by looking for a <code>pyproject.toml</code>, or by creating an ephemeral environment for a single script.</p><p><strong>Editable Installs:</strong> By default, <code>uv</code> installs your project in &ldquo;editable&rdquo; mode so changes to source code are reflected immediately.</p><p><strong>Tool Execution:</strong> <code>uvx</code> (or <code>uv tool run</code>) allows running tools in isolated, temporary environments without affecting your project.</p><p><strong>Multiple Environments:</strong> <code>uv</code> makes it trivial to test against multiple Python versions, either by switching the main environment or by maintaining side-by-side environments using <code>UV_PROJECT_ENVIRONMENT</code>.</p></div></details><h1 id=running-code-with-uv-run>Running Code with <code>uv run</code><a class=anchor href=#running-code-with-uv-run>#</a></h1><p><code>uv run</code> is the Swiss Army knife of <code>uv</code>.
It is the primary way to execute Python code, scripts, or project entrypoints while ensuring they run in the correct,
isolated environment.</p><p>The most important thing to remember about <code>uv run</code> is that <strong>it is not just a wrapper</strong>.
It manages the environment <em>before</em> execution.
If your environment is out of sync with your <code>pyproject.toml</code> or <code>uv.lock</code>,
<code>uv run</code> will automatically perform a sync in the background before starting your program.</p><p>This will automatically, quickly and invisibly ensure that your code runs in a fresh environment.</p><h2 id=ways-to-use-uv-run>Ways to use <code>uv run</code><a class=anchor href=#ways-to-use-uv-run>#</a></h2><h3 id=uv-run-something><code>uv run &lt;something></code><a class=anchor href=#uv-run-something>#</a></h3><p>If you run a command that isn&rsquo;t a Python script,
<code>uv</code> looks for it in the virtual environment&rsquo;s <code>bin</code> (or <code>Scripts</code> on Windows) directory.
You can&rsquo;t <code>uv run</code> a thing that wasn&rsquo;t specified and isn&rsquo;t installed.
That&rsquo;s intentional, keep your project metadata up to date, keep OS dependencies out of the project.
This is the only way to ensure consistency.</p><p>In our <code>berlin-weather</code> project, we defined an entrypoint in <code>pyproject.toml</code>:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[project.scripts]
</span></span><span style=display:flex><span>berlin-weather = <span style=color:#5af78e>&#34;berlin_weather.cli:main&#34;</span></span></span></code></pre></div><p>We can run this simply with:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run berlin-weather</span></span></code></pre></div><p><code>uv</code> ensures the <code>.venv</code> is up to date and then executes the <code>berlin-weather</code> script.</p><h3 id=uv-run-scriptpy><code>uv run &lt;script>.py</code><a class=anchor href=#uv-run-scriptpy>#</a></h3><p>If the argument ends in <code>.py</code>, <code>uv</code> treats it as a Python script. It is effectively a shorthand for <code>uv run python &lt;script>.py</code>.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run whoami.py</span></span></code></pre></div><h3 id=uv-run--m-module><code>uv run -m &lt;module></code><a class=anchor href=#uv-run--m-module>#</a></h3><p>Just like <code>python -m</code>, this runs an installed module as a script.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run -m json.tool blah.json</span></span></code></pre></div><h3 id=uv-run--><code>uv run -</code><a class=anchor href=#uv-run-->#</a></h3><p>You can pipe Python code directly into <code>uv run -</code>. This executes the code using the project&rsquo;s Python interpreter and environment.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff5c57>echo</span> <span style=color:#5af78e>&#34;import httpx; print(httpx.__version__)&#34;</span> | uv run -</span></span></code></pre></div><h2 id=where-the-environment-comes-from>Where the environment comes from<a class=anchor href=#where-the-environment-comes-from>#</a></h2><p>One of the &ldquo;magic&rdquo; aspects of <code>uv run</code> is how it decides which environment to use.
It follows a specific discovery hierarchy:</p><dl><dt>Project Discovery</dt><dd><code>uv</code> looks for a <code>pyproject.toml</code> in the current directory or any parent directory.
If found, it uses the environment associated with that project (the <code>.venv</code> directory).</dd><dt>Script Metadata</dt><dd>If you run <code>uv run script.py</code> and that script contains <a href=https://peps.python.org/pep-0723/>PEP 723</a> inline metadata,
<code>uv</code> creates a temporary, ephemeral environment just for that script.</dd><dt>Remote Scripts</dt><dd>You can even run scripts directly from a URL:<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run https://raw.githubusercontent.com/astral-sh/uv/main/scripts/uv-elapsed.py</span></span></code></pre></div><p><code>uv</code> will download the script, look for metadata, create an environment, and run it.</p></dd></dl><blockquote class='book-hint warning'><p>If a virtual environment is already &ldquo;active&rdquo; in your shell (e.g., via <code>source .venv/bin/activate</code>),
<code>uv run</code> will still prefer the environment it discovers via <code>pyproject.toml</code>.
It is generally recommended <strong>not</strong> to activate environments when using <code>uv</code>.</p></blockquote><h2 id=argument-separation>Argument Separation<a class=anchor href=#argument-separation>#</a></h2><p>When using <code>uv run</code>, you often need to pass parameters to the command you are running.
<code>uv</code> parameters must come after the <code>run</code> and before the command that <code>uv</code> is suppsed to run.</p><p>To make things clearer, you can expressly end the <code>uv</code> parameters list usingthe double-dash <code>--</code> separator:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#78787e># uv run &lt;uv params&gt; -- &lt;command&gt; &lt;command params&gt;</span>
</span></span><span style=display:flex><span>uv run --python 3.12 -- berlin-weather --verbose</span></span></code></pre></div><p>In this example, <code>--python 3.12</code> is for <code>uv</code>, while <code>--verbose</code> is passed to the <code>berlin-weather</code> application.
Usually this is not needed,</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run --python 3.12 berlin-weather --verbose</span></span></code></pre></div><p>will work just the same.</p><h1 id=editable-installs>Editable Installs<a class=anchor href=#editable-installs>#</a></h1><p>By default, when you work within a project,
<code>uv</code> installs your project into the virtual environment in <strong>editable mode</strong>.</p><h3 id=what-is-editable>What is &ldquo;Editable&rdquo;?<a class=anchor href=#what-is-editable>#</a></h3><p>In traditional Python, if you install a package, its files are copied into <code>site-packages</code>.
If you change your source code, you have to reinstall the package to see the changes.</p><p>An <strong>editable install</strong> (often called <code>pip install -e .</code>) creates a link (or a special <code>.pth</code> file)
in <code>site-packages</code> that points back to your source directory.</p><ul><li><strong>In <code>src</code> layout (<code>--package</code>):</strong> <code>uv</code> handles the complexity of making the <code>src/berlin_weather</code> folder importable.
It does that by adding the <code>src</code> directory to <code>sys.path</code> (in fact, it adds the directory named in the <code>.pth</code> file to the search path, and this happens to be the <code>src</code> directory).</li><li><strong>In flat layout:</strong> The current directory is made available.
This is dangerous, because it can lead to unexpected behavior if you have files with the same name as modules in your project.
That&rsquo;s one of multiple reasons why we discourage the use &ldquo;flat&rdquo; layout in Python and prefer the <code>src</code> layout created with <code>--package</code>.</li></ul><p>An editable install means you can edit your code in <code>src/berlin_weather/ cli.py</code> and immediately see the effect when you run <code>uv run berlin-weather</code>, without any re-installation step.</p><h3 id=uv-run---no-editable><code>uv run --no-editable</code><a class=anchor href=#uv-run---no-editable>#</a></h3><p>Sometimes you want to test your project as if it were a regular, non-editable installation (e.g.,
to ensure you haven&rsquo;t forgotten to include a file in your package).</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run --no-editable berlin-weather</span></span></code></pre></div><p>This forces <code>uv</code> to build a temporary wheel of your project and install it properly into the environment,
rather than linking to your source code.</p><h1 id=tool-execution-and-uvx>Tool Execution and <code>uvx</code><a class=anchor href=#tool-execution-and-uvx>#</a></h1><p>Sometimes you want to run a tool (like <code>ruff</code> or <code>pytest</code>) that isn&rsquo;t necessarily a dependency of your project,
or you want to run it without setting up a project at all.</p><h3 id=what-is-uvx>What is <code>uvx</code>?<a class=anchor href=#what-is-uvx>#</a></h3><p><code>uvx</code> is a convenient shorthand for <code>uv tool run</code>. It is designed for one-off tool execution.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uvx ruff format .</span></span></code></pre></div><p>When you run this:</p><ol><li><code>uv</code> creates an isolated, cached environment for <code>ruff</code>.</li><li>It installs <code>ruff</code> into that environment.</li><li>It executes the command.</li><li>The environment is kept in the cache for future use, but it doesn&rsquo;t clutter your project&rsquo;s <code>.venv</code>.</li></ol><h3 id=common-tool-examples>Common Tool Examples<a class=anchor href=#common-tool-examples>#</a></h3><p>Inside a project, you typically use <code>uv run</code> for tools declared in your <code>dev</code> group:</p><ul><li><strong>Testing:</strong> <code>uv run pytest</code></li><li><strong>Linting & Formatting:</strong><ul><li><code>uv run ruff format src</code> (Replaces <code>black</code>)</li><li><code>uv run ruff check --fix src</code> (Replaces <code>pylint</code> and <code>isort</code>)</li></ul></li><li><strong>Type Checking:</strong> <code>uv run mypy src</code></li></ul><h3 id=automatic-parameter-supply>Automatic Parameter Supply<a class=anchor href=#automatic-parameter-supply>#</a></h3><p>In many projects, you find yourself running the same long commands.
While <code>uv</code> doesn&rsquo;t have a built-in &ldquo;task runner&rdquo; like <code>npm run</code>,
it encourages the use of entrypoints or simple shell aliases.</p><h1 id=multiple-environments>Multiple Environments<a class=anchor href=#multiple-environments>#</a></h1><p>Because <code>uv</code> makes environment creation so cheap, you can easily test your code against multiple versions of Python.</p><h3 id=example-multi-version-testing>Example: Multi-version testing<a class=anchor href=#example-multi-version-testing>#</a></h3><p>If you want to ensure <code>berlin-weather</code> works on both Python 3.12 and 3.13:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv run --managed-python --python 3.12 pytest
</span></span><span style=display:flex><span>uv run --managed-python --python 3.13 pytest</span></span></code></pre></div><p><code>uv</code> will create matching <code>.venv</code> states or cached environments for these calls,
allowing you to switch back and forth instantly.
This is a powerful way to verify compatibility without the complexity of managing multiple manual installations.</p><h3 id=side-by-side-environments>Side-by-side environments<a class=anchor href=#side-by-side-environments>#</a></h3><p>Sometimes, you don&rsquo;t want <code>uv</code> to overwrite your main <code>.venv</code> every time you switch Python versions.
You might want to keep your development environment in <code>.venv</code> (e.g., using Python 3.13)
while having separate, persistent environments for testing against other versions.</p><p>You can achieve this by using the <code>UV_PROJECT_ENVIRONMENT</code> environment variable to point <code>uv</code> to a different directory:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#78787e># Create and sync the 3.12 environment</span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.12 uv sync --managed-python --python 3.12 --all-groups
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#78787e># Create and sync the 3.13 environment</span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.13 uv sync --managed-python --python 3.13 --all-groups
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#78787e># Run tests using the respective environments</span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.12 uv run --managed-python --python 3.12 --all-groups pytest
</span></span><span style=display:flex><span><span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.13 uv run --managed-python --python 3.13 --all-groups pytest</span></span></code></pre></div><p>By setting <code>UV_PROJECT_ENVIRONMENT</code>, you tell <code>uv</code> to use that specific directory instead of the default <code>.venv</code>.
This allows you to keep multiple virtual environments side-by-side in the same project directory,
and switching between them is as simple as changing the environment variable.
The default <code>uv run --all-groups pytest</code> (without the variable) will still use your main <code>.venv</code> directory.</p><h3 id=simplifying-multi-environment-commands>Simplifying multi-environment commands<a class=anchor href=#simplifying-multi-environment-commands>#</a></h3><p>Currently, <code>uv</code> does not have a built-in way to define these side-by-side environments in <code>pyproject.toml</code> or <code>uv.toml</code>.
If you find yourself frequently typing these long commands, the recommended approach is to use shell aliases,
a <code>Makefile</code>, or a task runner like <code>just</code>.</p><h4 id=option-1-shell-aliases>Option 1: Shell Aliases<a class=anchor href=#option-1-shell-aliases>#</a></h4><p>Add these to your <code>.bashrc</code> or <code>.zshrc</code>:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff5c57>alias</span> uv-test-312<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;UV_PROJECT_ENVIRONMENT=.venv-3.12 uv run --managed-python --python 3.12 --all-groups&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>alias</span> uv-test-313<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;UV_PROJECT_ENVIRONMENT=.venv-3.13 uv run --managed-python --python 3.13 --all-groups&#39;</span></span></span></code></pre></div><p>Now you can simply run:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uv-test-312 pytest</span></span></code></pre></div><h4 id=option-2-a-simple-makefile>Option 2: A simple <code>Makefile</code><a class=anchor href=#option-2-a-simple-makefile>#</a></h4><p>Create a <code>Makefile</code> in your project root:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-make data-lang=make><span style=display:flex><span><span style=color:#57c7ff>.PHONY</span><span style=color:#ff6ac1>:</span> test-312 test-313 test-all
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57c7ff>test-312</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span>	<span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.12 uv run --managed-python --python 3.12 --all-groups pytest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57c7ff>test-313</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span>	<span style=color:#ff5c57>UV_PROJECT_ENVIRONMENT</span><span style=color:#ff6ac1>=</span>.venv-3.13 uv run --managed-python --python 3.13 --all-groups pytest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57c7ff>test-all</span><span style=color:#ff6ac1>:</span> test-312 test-313</span></span></code></pre></div><p>Then run <code>make test-all</code> to test against both versions.</p><h1 id=scripts>Scripts<a class=anchor href=#scripts>#</a></h1><p>Python has a way to specify dependencies inline in scripts, initially defined in
<a href=https://peps.python.org/pep-0723/>PEP-723</a> and now maintained in
<a href=https://packaging.python.org/en/latest/specifications/inline-script-metadata/#inline-script-metadata>Inline Script Metadata</a>.</p><p><code>uv</code> can work with such inline script metadata.
Do make it do so, provide the option <code>--script</code>.</p><h2 id=example-script>Example script<a class=anchor href=#example-script>#</a></h2><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#78787e># Script at /whoami/whoami.py in this repository, https://github.com/isotopp/uv-class</span>
</span></span><span style=display:flex><span><span style=color:#78787e># /// script</span>
</span></span><span style=display:flex><span><span style=color:#78787e># requires-python = &#34;&gt;=3.11&#34;</span>
</span></span><span style=display:flex><span><span style=color:#78787e># dependencies = [</span>
</span></span><span style=display:flex><span><span style=color:#78787e>#   &#34;httpx&gt;=0.26&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#78787e># ]</span>
</span></span><span style=display:flex><span><span style=color:#78787e># ///</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> datetime <span style=color:#ff6ac1>import</span> datetime, timezone
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> email.utils <span style=color:#ff6ac1>import</span> parsedate_to_datetime
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> httpx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>main</span>() <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>with</span> httpx<span style=color:#ff6ac1>.</span>Client(timeout<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>10.0</span>) <span style=color:#ff6ac1>as</span> client:
</span></span><span style=display:flex><span>        r <span style=color:#ff6ac1>=</span> client<span style=color:#ff6ac1>.</span>get(<span style=color:#5af78e>&#34;https://httpbin.org/get&#34;</span>)
</span></span><span style=display:flex><span>        r<span style=color:#ff6ac1>.</span>raise_for_status()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff5c57>print</span>(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;Your apparent IP: </span><span style=color:#5af78e>{</span>r<span style=color:#ff6ac1>.</span>json()<span style=color:#ff6ac1>.</span>get(<span style=color:#5af78e>&#39;origin&#39;</span>, <span style=color:#5af78e>&#39;unknown&#39;</span>)<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> <span style=color:#ff5c57>__name__</span> <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()</span></span></code></pre></div><p>This short program calls <code>https://httpbin.org/get</code> to get the current IP.</p><p>Running this script without <code>uv</code> or without the <code>/// script</code> header results in an error due to <code>httpx</code> missing.</p><pre tabindex=0><code>$ uv run whoami.py
Traceback (most recent call last):
  File &#34;~/Source/uv-class/whoami/whoami.py&#34;, line 5, in &lt;module&gt;
    import httpx
ModuleNotFoundError: No module named &#39;httpx&#39;</code></pre><p>With the metadata block present, <code>uv</code> autodetects the metadata block (or we provide <code>--script</code>)
and creates an ephemeral virtual environment with <code>httpx</code> installed.</p><pre tabindex=0><code>$ uv run --verbose whoami.py
DEBUG uv 0.9.21 (0dc9556ad 2025-12-30)
DEBUG Acquired shared lock for `~/.cache/uv`
DEBUG Reading inline script metadata from `whoami.py`
DEBUG Acquired exclusive lock for `~/Source/uv-class/whoami/whoami.py`
DEBUG No Python version file found in ancestors of working directory: ~/Source/uv-class/whoami
DEBUG Using Python request Python &gt;=3.11 from `requires-python` metadata
DEBUG Checking for Python environment at: `~/.cache/uv/environments-v2/whoami-0492c73d0afa970a`
DEBUG The script environment&#39;s Python version satisfies the request: `Python &gt;=3.11`
DEBUG Released lock at `/var/folders/dn/vtkw12w17qv7cqw5yj6lmgjh0000gn/T/uv-0492c73d0afa970a.lock`
DEBUG Acquired exclusive lock for `~/.cache/uv/environments-v2/whoami-0492c73d0afa970a`
DEBUG All requirements satisfied: anyio | certifi | h11&gt;=0.16 | httpcore==1.* | httpx&gt;=0.26 | idna | idna&gt;=2.8
DEBUG Released lock at `~/.cache/uv/environments-v2/whoami-0492c73d0afa970a/.lock`
DEBUG Using Python 3.14.2 interpreter at: ~/.cache/uv/environments-v2/whoami-0492c73d0afa970a/bin/python3
DEBUG Running `python whoami.py`
DEBUG Spawned child 28443 in process group 28442
Your apparent IP: 62.166.154.224
DEBUG Command exited with code: 0
DEBUG Released lock at `~/.cache/uv/.lock`</code></pre><p>The line <code>DEBUG Reading inline script metadata from whoami.py</code> shows us that the metadata block is autodetected.</p><p>The line <code>DEBUG Checking for Python environment at: ~/.cache/uv/environments-v2/whoami-0492c73d0afa970a</code>
shows us that <code>uv</code> is looking for a Python environment in the cache directory.
This environment is kept stable and is re-used,
but is transient in the sense that <code>uv</code> can decide to trash and rebuilt it with a different name any time.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/books/uv-class/05-dependencies/ class="flex align-center"><img src=/icons/backward.svg class=book-icon alt=Backward>
<span>Dependencies, environments, and reproducibility</span>
</a></span><span><a href=/books/uv-class/07-collaboration/ class="flex align-center"><span>Project hygiene and collaboration</span>
<img src=/icons/forward.svg class=book-icon alt=Forward></a></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#running-code-with-uv-run>Running Code with <code>uv run</code></a><ul><li><a href=#ways-to-use-uv-run>Ways to use <code>uv run</code></a><ul><li><a href=#uv-run-something><code>uv run &lt;something></code></a></li><li><a href=#uv-run-scriptpy><code>uv run &lt;script>.py</code></a></li><li><a href=#uv-run--m-module><code>uv run -m &lt;module></code></a></li><li><a href=#uv-run--><code>uv run -</code></a></li></ul></li><li><a href=#where-the-environment-comes-from>Where the environment comes from</a></li><li><a href=#argument-separation>Argument Separation</a></li></ul></li><li><a href=#editable-installs>Editable Installs</a><ul><li><ul><li><a href=#what-is-editable>What is &ldquo;Editable&rdquo;?</a></li><li><a href=#uv-run---no-editable><code>uv run --no-editable</code></a></li></ul></li></ul></li><li><a href=#tool-execution-and-uvx>Tool Execution and <code>uvx</code></a><ul><li><ul><li><a href=#what-is-uvx>What is <code>uvx</code>?</a></li><li><a href=#common-tool-examples>Common Tool Examples</a></li><li><a href=#automatic-parameter-supply>Automatic Parameter Supply</a></li></ul></li></ul></li><li><a href=#multiple-environments>Multiple Environments</a><ul><li><ul><li><a href=#example-multi-version-testing>Example: Multi-version testing</a></li><li><a href=#side-by-side-environments>Side-by-side environments</a></li><li><a href=#simplifying-multi-environment-commands>Simplifying multi-environment commands</a></li></ul></li></ul></li><li><a href=#scripts>Scripts</a><ul><li><a href=#example-script>Example script</a></li></ul></li></ul></nav></div></aside></main></body></html>